# IRPA Moonlighter Scheduling System

> A fair, automated scheduling system for moonlighter shifts built for UVA Division of Pulmonary and Critical Care Medicine.

## Quick Start

### For Faculty (Sign Up)

1. Visit: https://moonlighter-web.fly.dev/signup.html
2. Select your name
3. Choose desired nights per month
4. Click dates you're available
5. Click "Save My Signup"

### For Admins (Generate Schedule)

1. Visit: https://moonlighter-web.fly.dev/Admin.html
2. Select month
3. Click "Run optimizer for month"
4. Download schedule or view in browser

## Features

- ✅ **Fair Distribution** - Balances assignments across faculty
- ✅ **Faculty Preferences** - Respects desired nights and availability
- ✅ **Multi-Month Support** - Sign up for multiple months at once
- ✅ **Mobile Friendly** - Works on phones and tablets
- ✅ **Cost Efficient** - Auto-stops when idle (~$2-3/month)
- ✅ **No Installation** - Just visit the URL

## How It Works

1. **Faculty sign up** - Select which nights they want to work
2. **Optimizer runs** - Algorithm assigns shifts fairly
3. **Admin reviews** - Check schedule and make adjustments
4. **Distribute** - Email schedule to all faculty

## Technology Stack

- **Backend**: FastAPI (Python)
- **Database**: SQLite with persistent storage
- **Optimizer**: Custom scheduling algorithm
- **Hosting**: Fly.io (auto-scaling)
- **Frontend**: Vanilla HTML/CSS/JavaScript

## Repository Structure

```
├── backend/
│   ├── app.py              # FastAPI application
│   ├── models.py           # Database models
│   └── optimizer_bridge.py # Connects DB to optimizer
├── moonlighter_optimizer.py # Scheduling algorithm
├── signup.html             # Faculty signup page
├── Admin.html              # Admin dashboard
├── faculty.csv             # Provider seed data
├── Dockerfile              # Container definition
├── fly.toml                # Fly.io configuration
└── requirements.txt        # Python dependencies
```

## Deployment

See [DEPLOYMENT.md](DEPLOYMENT.md) for complete deployment instructions.

**Quick deploy:**

```bash
# Create volume (one time)
fly volumes create moonlighter_data --region iad --size 1

# Deploy
fly deploy
```

## Development

### Run Locally

```bash
# Install dependencies
pip install -r requirements.txt

# Run server
uvicorn backend.app:app --reload --port 8080

# Visit
open http://localhost:8080/signup.html
```

### Database

SQLite database schema:

- **providers** - Faculty members
- **months** - Scheduling periods
- **shifts** - Individual dates
- **signups** - Faculty availability requests
- **assignments** - Final schedule (generated by optimizer)

## Cost

- **Storage**: $0.15/month (1GB volume)
- **Compute**: ~$2-3/month (auto-stops when idle)
- **Total**: ~$24-36/year

## Support

For issues or questions:

1. Check [DEPLOYMENT.md](DEPLOYMENT.md) troubleshooting section
2. View logs: `fly logs`
3. Open an issue on GitHub

## License

Internal use for UVA Health.

## Credits

Built by Platypus Inc. for UVA Division of Pulmonary and Critical Care Medicine.
